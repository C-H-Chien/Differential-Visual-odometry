function Df = self_getGradientsOfCurvePts(x,y,z,s)
    grad_Df1x = (y^2*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (3*y^2*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(4*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(5/2)) + (s*y^2*cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) + (8*s*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (8*s*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (4*s*y^2*z^2*((8*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (8*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (8*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2);
    grad_Df2x = (2*y*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1)*((8*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (8*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (8*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) - (2*y*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3)*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (2*s*y*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2)));
    grad_Df3x = (4*s*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (y^2*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)))/(2*(s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) + (8*s*y^2*z*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (y^2*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (4*s*y^2*z*((8*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (8*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (8*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) + (3*y^2*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(4*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(5/2)) - (s*y^2*z*cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y^2*z^2)/((s - x)^3*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*(2*(- z^2/(s - x) + x)*(z^2/(s - x)^2 - 1) - (2*y^2*z^2)/(s - x)^3))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(2*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2);
    
    grad_Df1y = (y*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (2*y^3*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*(z^2/(s - x)^2 + 1))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (3*y^2*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (4*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (4*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(4*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(5/2)) + (s*y^2*cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (4*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (4*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) + (8*s*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (16*s*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (4*s*y^2*z^2*((8*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (16*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (8*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (16*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2);
    grad_Df2y = (2*y*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1)*((8*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (16*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (8*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (16*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) - (2*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (4*y^2*(z^2/(s - x)^2 + 1)*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (2*s*y*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (4*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (4*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2)));
    grad_Df3y = (8*s*y*z)/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (y*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (16*s*y^3*z*(z^2/(s - x)^2 + 1))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (2*y^3*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*(z^2/(s - x)^2 + 1))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (4*s*y^2*z*((8*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (16*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (8*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (16*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) + (3*y^2*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (4*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (4*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(4*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(5/2)) - (s*y^2*z*cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 - (4*y^3*(z^2/(s - x)^2 + 1))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 + (2*y*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) - (4*y^3*z^2*(z^2/(s - x)^2 + 1))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(2*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2);
    
    grad_Df1z = (3*y^2*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (2*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(4*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(5/2)) - (y^2*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) - (s*y^2*cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (2*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) + (8*s*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (4*s*y^2*z^2*((8*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (8*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (8*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) - (8*s*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2)));
    grad_Df2z = (2*y*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x))*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (2*y*(cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)) - 1)*((8*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (8*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (8*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) - (2*s*y*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (2*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2)));
    grad_Df3z = (4*s*y^2)/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) - (y^2*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2)))/(2*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) + (4*s*y^2*z*((8*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (8*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (8*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*((4*y^2)/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2) - (3*y^2*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (2*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(4*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(5/2)) - (8*s*y^2*z*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*((4*y^2)/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (4*y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))) + (y^2*z*sin(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(3/2)) + (s*y^2*z*cos(2*s*(y^2/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2))^(1/2))*((2*y^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3 - (2*y^2*z)/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2) + (2*y^2*z^2*((2*y^2*z)/(s - x)^2 - (4*z*(- z^2/(s - x) + x))/(s - x)))/((s - x)^2*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^3)))/(2*(s - x)*((- z^2/(s - x) + x)^2 + y^2*(z^2/(s - x)^2 + 1))^2*(y^2/((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2 + (y^2*z^2)/((s - x)^2*((x - z^2/(s - x))^2 + y^2*(z^2/(s - x)^2 + 1))^2))^2);
    
    Df.f1x = grad_Df1x;
    Df.f2x = grad_Df2x;
    Df.f3x = grad_Df3x;
    
    Df.f1y = grad_Df1y;
    Df.f2y = grad_Df2y;
    Df.f3y = grad_Df3y;
    
    Df.f1z = grad_Df1z;
    Df.f2z = grad_Df2z;
    Df.f3z = grad_Df3z;
end